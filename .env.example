# ================================================================
# RAG Chat Storage Microservice - Environment Variables
# ================================================================
# Copy this file to .env and update with your actual values
# Command: cp .env.example .env
# ================================================================

# ================================================================
# APPLICATION CONFIGURATION
# ================================================================
# Application name (used in Spring Boot)
APP_NAME=rag-chat-storage

# ================================================================
# SERVER CONFIGURATION
# ================================================================
# Port on which the application runs
SERVER_PORT=8080

# ================================================================
# MONGODB DATABASE CONFIGURATION
# ================================================================
# MongoDB connection string
# Format: mongodb://[username:password@]host[:port]/database[?options]
# Development: mongodb://localhost:27017/rag-chat-storage
# Production: mongodb://username:password@mongo-host:27017/rag-chat-storage?authSource=admin
MONGODB_URI=mongodb://mongo:27017/rag-chat-storage

# ================================================================
# CACHE CONFIGURATION (Caffeine In-Memory Cache)
# ================================================================
# Cache implementation type (caffeine, redis, etc.)
CACHE_TYPE=caffeine

# Cache specification string
# Format: maximumSize=<size>,expireAfterWrite=<time>,expireAfterAccess=<time>,recordStats
# maximumSize: Maximum number of entries in cache
# expireAfterWrite: Time after which entries expire (e.g., 10m, 1h, 30s)
# expireAfterAccess: Time of inactivity before expiring (e.g., 5m)
# recordStats: Enable cache statistics
CACHE_SPEC=maximumSize=1000,expireAfterWrite=10m,expireAfterAccess=5m,recordStats

# ================================================================
# SECURITY CONFIGURATION (API Key Authentication)
# ================================================================
# API key for authentication - CHANGE THIS IN PRODUCTION!
# This key must be included in X-API-KEY header for all /api/** requests
# Generate a strong random key for production (min 32 characters)
# Example: openssl rand -hex 32
SECURITY_API_KEY=changeme

# HTTP header name for API key authentication
# Default: X-API-KEY
SECURITY_API_KEY_HEADER=X-API-KEY

# ================================================================
# CORS CONFIGURATION (Cross-Origin Resource Sharing)
# ================================================================
# Comma-separated list of allowed origins
# Development: http://localhost:3000
# Production: https://yourdomain.com,https://admin.yourdomain.com
# Use * for all origins (NOT recommended in production)
CORS_ALLOWED_ORIGINS=http://localhost:3000

# Comma-separated list of allowed HTTP methods
CORS_ALLOWED_METHODS=GET,POST,PATCH,DELETE,OPTIONS

# Allowed headers (* = all headers)
CORS_ALLOWED_HEADERS=*

# Maximum age (in seconds) for CORS preflight cache
CORS_MAX_AGE=3600

# ================================================================
# PAGINATION CONFIGURATION
# ================================================================
# Default number of items per page when not specified
PAGINATION_DEFAULT_PAGE_SIZE=20

# Maximum allowed page size (prevents abuse)
PAGINATION_MAX_PAGE_SIZE=100

# ================================================================
# ACTUATOR CONFIGURATION (Monitoring & Health Checks)
# ================================================================
# Comma-separated list of exposed actuator endpoints
# Available: health, info, metrics, caches, env, loggers, etc.
ACTUATOR_ENDPOINTS=health,info,metrics,caches

# Enable Kubernetes-style liveness and readiness probes
# /actuator/health/liveness and /actuator/health/readiness
ACTUATOR_HEALTH_PROBES=true

# Enable cache metrics instrumentation
ACTUATOR_CACHE_METRICS=true

# ================================================================
# LOGGING CONFIGURATION
# ================================================================
# Root logging level (TRACE, DEBUG, INFO, WARN, ERROR)
LOG_LEVEL_ROOT=INFO

# Application-specific logging level
LOG_LEVEL_APP=DEBUG

# Spring Web logging level (HTTP requests/responses)
LOG_LEVEL_WEB=DEBUG

# Spring Security logging level (authentication/authorization)
LOG_LEVEL_SECURITY=DEBUG

# Console log pattern
# %d = timestamp, %msg = message, %n = newline
LOG_PATTERN_CONSOLE=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# File log pattern
# %thread = thread name, %-5level = log level (padded to 5 chars), %logger{36} = logger name
LOG_PATTERN_FILE=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ================================================================
# ACCESS LOG CONFIGURATION (Tomcat HTTP Access Logs)
# ================================================================
# Enable/disable HTTP access logging
ACCESS_LOG_ENABLED=true

# Access log pattern
# %h = remote host, %l = remote logical username, %u = remote user
# %t = timestamp, %r = first line of request, %s = HTTP status code
# %b = bytes sent, %D = time taken in milliseconds
ACCESS_LOG_PATTERN=%h %l %u %t \"%r\" %s %b %D

# Directory for access log files (relative to application)
ACCESS_LOG_DIRECTORY=logs

# Access log file prefix
ACCESS_LOG_PREFIX=access_log

# Access log file suffix
ACCESS_LOG_SUFFIX=.log

# ================================================================
# SWAGGER/OPENAPI CONFIGURATION (API Documentation)
# ================================================================
# Enable/disable Swagger UI
# Set to false in production if you don't want to expose API docs
SWAGGER_ENABLED=true

# Path for OpenAPI JSON/YAML documentation
SWAGGER_API_DOCS_PATH=/v3/api-docs

# Path for Swagger UI web interface
SWAGGER_UI_PATH=/swagger-ui.html

# API documentation title
SWAGGER_TITLE=RAG Chat Storage Microservice API

# API version
SWAGGER_VERSION=1.0

# API description
SWAGGER_DESCRIPTION=Production-ready backend microservice to store chat sessions, messages, and RAG context

# ================================================================
# NGINX RATE LIMITING CONFIGURATION
# ================================================================
# Number of requests allowed per minute per IP address
# Development: 300 (more relaxed)
# Production: 60 (stricter)
RATE_LIMIT_PER_MINUTE=60

# Burst capacity - additional requests allowed in bursts
# This allows temporary spikes in traffic
RATE_LIMIT_BURST=10

# ================================================================
# PRODUCTION CONFIGURATION EXAMPLES
# ================================================================
# Uncomment and modify these for production deployments

# Production MongoDB with authentication
# MONGODB_URI=mongodb://admin:SecurePassword123@prod-mongo-cluster:27017/rag-chat-storage?authSource=admin&replicaSet=rs0

# Production API Key (generate with: openssl rand -hex 32)
# SECURITY_API_KEY=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6

# Production CORS (specific domains only)
# CORS_ALLOWED_ORIGINS=https://app.example.com,https://admin.example.com

# Production Rate Limiting (stricter)
# RATE_LIMIT_PER_MINUTE=30
# RATE_LIMIT_BURST=5

# Production Logging (less verbose)
# LOG_LEVEL_ROOT=WARN
# LOG_LEVEL_APP=INFO
# LOG_LEVEL_WEB=WARN
# LOG_LEVEL_SECURITY=INFO

# Disable Swagger in production
# SWAGGER_ENABLED=false

# ================================================================
# DEVELOPMENT CONFIGURATION EXAMPLES
# ================================================================
# Uncomment these for local development

# Development Rate Limiting (more relaxed)
# RATE_LIMIT_PER_MINUTE=300
# RATE_LIMIT_BURST=50

# Development Logging (very verbose)
# LOG_LEVEL_ROOT=DEBUG
# LOG_LEVEL_APP=TRACE

# ================================================================
# DOCKER COMPOSE SPECIFIC
# ================================================================
# These are automatically set by docker-compose.yml
# No need to set manually unless running outside Docker

# MongoDB host (set by Docker Compose service name)
# Automatically uses "mongo" service from docker-compose.yml

# ================================================================
# NOTES
# ================================================================
#
# Security Best Practices:
# 1. NEVER commit .env file to version control
# 2. ALWAYS use strong, random API keys in production
# 3. Rotate API keys regularly
# 4. Use different keys for dev/staging/production
# 5. Store production secrets in secure vault (AWS Secrets Manager, HashiCorp Vault, etc.)
#
# Environment Variable Priority:
# 1. System environment variables (highest priority)
# 2. .env file
# 3. application.yml defaults (lowest priority)
#
# Generate Secure API Key:
#   openssl rand -hex 32
#   or
#   openssl rand -base64 32
#
# Docker Usage:
#   docker-compose up --build
#
# Environment-Specific Configs:
#   Create separate files: .env.dev, .env.staging, .env.prod
#   Then: cp .env.prod .env
#
# ================================================================

